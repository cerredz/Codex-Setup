Always start by creating a reports directory at .claude/reports/ if it does not already exist. You will operate in an iterative self-refinement loop where a single report file is progressively enhanced through multiple execution passes. Your process begins with Pass 1, where you receive the task description along with any relevant context materials (documents, files from .claude/commands/, data sources, requirements, or other input). Execute the assigned task completely, producing your first-pass output with maximum detail and thoroughness. Write this initial output to .claude/reports/{task_name}.md, where {task_name} is a brief slug describing the task (e.g., market_analysis.md, story_outline.md, research_synthesis.md).

The output format and structure should match whatever the task naturally demands—this could be a detailed list, a narrative document, a structured analysis, a creative piece, a technical specification, or any other format appropriate to the task. Regardless of format, every component must be incredibly detailed and comprehensive. Do not produce surface-level content, abbreviated sections, or placeholder text—each element must be exhaustive in its specificity, depth, and completeness. If writing analysis, include thorough reasoning, evidence, and implications. If creating plans, specify exact steps with full context. If producing creative work, develop every scene, character, or element fully. If synthesizing research, provide complete findings with detailed citations and connections. Whatever the task requires, execute it with granular precision where every part is developed to completion rather than sketched in outline form.

After completing Pass 1, immediately proceed to Pass 2 without waiting for user approval. Read the current contents of .claude/reports/{task_name}.md into your context as the starting reference point. Re-execute the exact same task with the exact same initial context materials you had in Pass 1, but now you additionally have the existing report content available as a lens. Approach the task completely fresh from the beginning—re-engage with all source materials, rethink all aspects of the work, and regenerate your output from scratch. This is not editing or revising the previous version; this is doing the entire task over again while informed by your previous attempt. The existing report helps you identify where detail was insufficient, where reasoning was shallow, what considerations were missed, where structure could be improved, what alternative approaches might be superior, or what entirely new dimensions should be explored. Completely overwrite .claude/reports/{task_name}.md with your new Pass 2 output—the previous version is replaced entirely by a fresh, complete execution of the task.

Continue this process for Pass 3: read the current .claude/reports/{task_name}.md (which now contains Pass 2 content), re-execute the entire task from scratch with all original context materials plus the existing report as reference, and completely overwrite the file with your Pass 3 output. Each subsequent pass maintains this pattern: load the current report state, re-engage with all original materials, and produce a full new output that replaces the previous version. You are not constrained by previous structure, phrasing, or organization—if a completely different approach would produce superior results, take it. The cumulative benefit comes from seeing your own prior work as a reference that reveals gaps, suggests improvements, and highlights opportunities for deeper development, while maintaining complete freedom to restructure, reframe, or reconceptualize the entire output.

Execute exactly five passes total unless explicitly instructed otherwise by the user. After completing Pass 5, add a metadata footer to .claude/reports/{task_name}.md:

---
Report Status: FINAL (5 passes completed)
Last Updated: [timestamp]
---
Do not output the report contents in your visible chat responses during the refinement process—all work happens silently in .claude/reports/{task_name}.md. After completing all five passes, your visible response should be brief: "Self-refining generation complete. Five iterative passes executed with progressive enhancement. Final output available at .claude/reports/{task_name}.md." If the user wants to see the report, they can request it explicitly. This process ensures deep, continuously refined work where each iteration enhances quality by adding missing detail, correcting weaknesses, improving clarity, expanding depth, and refining execution while maintaining a single coherent output that represents the cumulative benefit of multiple deliberate passes over the same task.

